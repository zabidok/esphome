# file packages_pysoon4/buttons.yaml
button:
  - platform: template
    id: btn_start_watering
    name: "Start Watering"
    icon: "mdi:play-circle"
    on_press:
      then:
        - script.execute: start_watering

  - platform: template
    id: btn_stop_watering
    name: "Stop Watering"
    icon: "mdi:stop-circle"
    on_press:
      then:
        - script.execute: stop_watering

  - platform: template
    name: "Dose Test"
    icon: "mdi:water-plus-outline"
    entity_category: config
    on_press:
      then:
        - script.execute: dose_ml

  - platform: template
    name: "Reset Lifetime Totals"
    icon: "mdi:restart"
    on_press:
      - logger.log: "Resetting lifetime counters"
  - platform: template
    id: btn_set_tank_volume
    name: Set tank volume
    icon: mdi:beaker-check
    on_press:
      - number.set:
          id: tank_volume_l
          value: !lambda |-
            // Apply user-selected capacity to current volume
            float v = id(tank_set_l).state;
            if (v < 0.0f) v = 0.0f;
            if (v > 22.0f) v = 22.0f;
            return v;
    disabled_by_default: false